<h1 style="display: inline-block">Das gibt es heute:</h1>
<ul style="list-style-type: none; display: inline-block; vertical-align: middle">
	{{#each availableCities}}
	<li style="float: left; padding: 5px;" onclick="switchFilter('{{this}}')"> {{this}} </li>
	{{/each}}
	<li style="float: left; padding: 5px;"></li>
	<li style="float: left; padding: 5px;" onclick="shareWithFriends()">Freund einladen</li>
</ul>

<script type="text/javascript">

	function setCity() {
		console.log('start with this city {{selectedCity}}');
		window.selectedCity = '{{selectedCity}}';
	};
	window.onload=setCity;
	
	function switchFilter(clickedCity){
		var suppliers = [{{#each suppliers}}'{{city}}'{{#if @last}}{{else}}, {{/if}}{{/each}}];
		var offerChilds = document.getElementById('offersParent').children;
		[].forEach.call(offerChilds, function(child, index){
			if (suppliers[index] === clickedCity) {
				child.style.display = 'inline-table';
			} else {
				child.style.display = 'none';
			}
		});
		window.selectedCity = clickedCity;
	};
	function shareWithFriends(){
		var subject = "{{userName}}'s Vorschläge für die Mittagspause";
		var body = 'Hi, hier die heutigen Mittagsgerichte meiner Lieblingsrestaurants in ' + window.selectedCity + ':\r\n\r\n';
		body += 'Visit us at http://localhost:3000 \r\n\r\n';
		{{#suppliers}}
			if (window.selectedCity === '{{city}}'){
				body += '{{supplierName}}\r\n';
				body +='{{timeOpen}} - {{timeClose}} {{#restaurantStatus timeOpen timeClose}}{{/restaurantStatus}}\r\n';
				{{#offers}}
					body += '{{dish}}\t\t{{price}}\r\n';
				{{/offers}}
				body += '\r\n';
			}
		{{/suppliers}}
		var uri = "mailto:?subject=";
    uri += encodeURIComponent(subject);
    uri += "&body=";
    uri += encodeURIComponent(body);
    var helpSend = window.open(uri, '_self');
	};
</script>

<div id='offersParent' style="width: 100%; margin: 0 0; text-align: center">
	{{#suppliers}}
	<div style="width: 280px; height: 150px; border-radius: 5px;border-width: 1px;border-color: grey;border-style: solid;padding: 10px;margin: 10px; text-align: left; display: {{#checkCity ../selectedCity city 'inline-table' 'none'}}{{/checkCity}};" onclick="switchVisible{{@index}}();">
		<div id="oben{{@index}}" style="display: inline-table">
			<span>{{timeOpen}} - {{timeClose}} {{#restaurantStatus timeOpen timeClose}}{{/restaurantStatus}}</span>
			<h3 style='margin-top: 2px;'>{{supplierName}}</h3>
			{{#offers}}
			<div style="width: 85%; display: inline-block">{{dish}}</div>
			<div style="width: 15%; display: inline-block">{{price}}</div>
			{{/offers}}
		</div>
		<div id="unten{{@index}}" style="display: none">
			<span>{{timeOpen}} - {{timeClose}}</span>
			<h3 style='margin-top: 2px;'>{{supplierName}}</h3>
				<div>{{street}}</div>
				<div>{{PLZ}} {{city}}</div>
				<div>{{tefl}}</div>
				<div>{{site}}</div>
				<div>{{email}}</div>
		</div>
		<script type="text/javascript">
			function switchVisible{{@index}}() {
	      if (document.getElementById('oben{{@index}}')) {
	        if (document.getElementById('oben{{@index}}').style.display == 'none') {
	          document.getElementById('oben{{@index}}').style.display = 'inline-table';
	          document.getElementById('unten{{@index}}').style.display = 'none';
	        } else {
	          document.getElementById('oben{{@index}}').style.display = 'none';
	          document.getElementById('unten{{@index}}').style.display = 'inline-table';
	        }
	      }
	    }
		</script>
	</div>
	{{/suppliers}}
</div>

{{> requestSupplier}}